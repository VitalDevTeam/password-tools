function addEntropyByte(a){entropyData[edlen++]=a}function ce(){addEntropyByte(Math.floor(255*(new Date).getMilliseconds()/999))}function addEntropy32(a){var b;for(b=0;4>b;b++)addEntropyByte(255&a),a>>=8}function addEntropyTime(){addEntropy32((new Date).getTime())}function mouseMotionEntropy(a){0>=mouseMotionCollect&&(mouseMotionCollect=a,document.implementation.hasFeature("Events","2.0")&&document.addEventListener?document.addEventListener("mousemove",mouseMoveEntropy,!1):document.attachEvent?document.attachEvent("onmousemove",mouseMoveEntropy):(oldMoveHandler=document.onmousemove,document.onmousemove=mouseMoveEntropy))}function mouseMoveEntropy(a){a||(a=window.event),mouseMotionCollect>0&&(mouseEntropyTime--<=0&&(addEntropyByte(255&a.screenX),addEntropyByte(255&a.screenY),ce(),mouseMotionCollect--,mouseEntropyTime=(entropyData[edlen-3]^entropyData[edlen-2]^entropyData[edlen-1])%19),0>=mouseMotionCollect&&(document.removeEventListener?document.removeEventListener("mousemove",mouseMoveEntropy,!1):document.detachEvent?document.detachEvent("onmousemove",mouseMoveEntropy):document.onmousemove=oldMoveHandler))}function keyFromEntropy(){var a,b=new Array(32);for(0==edlen&&alert("Blooie!  Entropy vector void at call to keyFromEntropy."),md5_init(),a=0;edlen>a;a+=2)md5_update(entropyData[a]);for(md5_finish(),a=0;16>a;a++)b[a]=digestBits[a];for(md5_init(),a=1;edlen>a;a+=2)md5_update(entropyData[a]);for(md5_finish(),a=0;16>a;a++)b[a+16]=digestBits[a];return b}var entropyData=new Array,edlen=0;addEntropyTime(),ce();var mouseMotionCollect=0,oldMoveHandler,mouseEntropyTime=0;
function cyclicShiftLeft(a,b){var c=a.slice(0,b);return a=a.slice(b).concat(c)}function xtime(a){return a<<=1,256&a?283^a:a}function mult_GF256(a,b){var c,d=0;for(c=1;256>c;c*=2,b=xtime(b))a&c&&(d^=b);return d}function byteSub(a,b){var c;c="encrypt"==b?SBox:SBoxInverse;for(var d=0;4>d;d++)for(var e=0;Nb>e;e++)a[d][e]=c[a[d][e]]}function shiftRow(a,b){for(var c=1;4>c;c++)a[c]="encrypt"==b?cyclicShiftLeft(a[c],shiftOffsets[Nb][c]):cyclicShiftLeft(a[c],Nb-shiftOffsets[Nb][c])}function mixColumn(a,b){for(var c=[],d=0;Nb>d;d++){for(var e=0;4>e;e++)c[e]="encrypt"==b?mult_GF256(a[e][d],2)^mult_GF256(a[(e+1)%4][d],3)^a[(e+2)%4][d]^a[(e+3)%4][d]:mult_GF256(a[e][d],14)^mult_GF256(a[(e+1)%4][d],11)^mult_GF256(a[(e+2)%4][d],13)^mult_GF256(a[(e+3)%4][d],9);for(var e=0;4>e;e++)a[e][d]=c[e]}}function addRoundKey(a,b){for(var c=0;Nb>c;c++)a[0][c]^=255&b[c],a[1][c]^=255&b[c]>>8,a[2][c]^=255&b[c]>>16,a[3][c]^=255&b[c]>>24}function keyExpansion(a){var c,b=new Array;Nk=keySizeInBits/32,Nb=blockSizeInBits/32,Nr=roundsArray[Nk][Nb];for(var d=0;Nk>d;d++)b[d]=a[4*d]|a[4*d+1]<<8|a[4*d+2]<<16|a[4*d+3]<<24;for(d=Nk;Nb*(Nr+1)>d;d++)c=b[d-1],0==d%Nk?c=(SBox[255&c>>8]|SBox[255&c>>16]<<8|SBox[255&c>>24]<<16|SBox[255&c]<<24)^Rcon[Math.floor(d/Nk)-1]:Nk>6&&4==d%Nk&&(c=SBox[255&c>>24]<<24|SBox[255&c>>16]<<16|SBox[255&c>>8]<<8|SBox[255&c]),b[d]=b[d-Nk]^c;return b}function Round(a,b){byteSub(a,"encrypt"),shiftRow(a,"encrypt"),mixColumn(a,"encrypt"),addRoundKey(a,b)}function InverseRound(a,b){addRoundKey(a,b),mixColumn(a,"decrypt"),shiftRow(a,"decrypt"),byteSub(a,"decrypt")}function FinalRound(a,b){byteSub(a,"encrypt"),shiftRow(a,"encrypt"),addRoundKey(a,b)}function InverseFinalRound(a,b){addRoundKey(a,b),shiftRow(a,"decrypt"),byteSub(a,"decrypt")}function encrypt(a,b){var c;if(a&&8*a.length==blockSizeInBits&&b){for(a=packBytes(a),addRoundKey(a,b),c=1;Nr>c;c++)Round(a,b.slice(Nb*c,Nb*(c+1)));return FinalRound(a,b.slice(Nb*Nr)),unpackBytes(a)}}function decrypt(a,b){var c;if(a&&8*a.length==blockSizeInBits&&b){for(a=packBytes(a),InverseFinalRound(a,b.slice(Nb*Nr)),c=Nr-1;c>0;c--)InverseRound(a,b.slice(Nb*c,Nb*(c+1)));return addRoundKey(a,b),unpackBytes(a)}}function byteArrayToHex(a){var b="";if(a){for(var c=0;c<a.length;c++)b+=(a[c]<16?"0":"")+a[c].toString(16);return b}}function hexToByteArray(a){var b=[];if(!(a.length%2)){(0==a.indexOf("0x")||0==a.indexOf("0X"))&&(a=a.substring(2));for(var c=0;c<a.length;c+=2)b[Math.floor(c/2)]=parseInt(a.slice(c,c+2),16);return b}}function packBytes(a){var b=new Array;if(a&&!(a.length%4)){b[0]=new Array,b[1]=new Array,b[2]=new Array,b[3]=new Array;for(var c=0;c<a.length;c+=4)b[0][c/4]=a[c],b[1][c/4]=a[c+1],b[2][c/4]=a[c+2],b[3][c/4]=a[c+3];return b}}function unpackBytes(a){for(var b=new Array,c=0;c<a[0].length;c++)b[b.length]=a[0][c],b[b.length]=a[1][c],b[b.length]=a[2][c],b[b.length]=a[3][c];return b}function formatPlaintext(a){var c,b=blockSizeInBits/8;if(("object"!=typeof a||"number"!=typeof a[0])&&("string"==typeof a||a.indexOf))for(a=a.split(""),c=0;c<a.length;c++)a[c]=255&a[c].charCodeAt(0);return c=a.length%b,c>0&&(a=a.concat(getRandomBytes(b-c))),a}function getRandomBytes(a){var b,c=new Array;for(b=0;a>b;b++)c[b]=prng.nextInt(255);return c}function rijndaelEncrypt(a,b,c){var d,e,f,h,g=blockSizeInBits/8;if(a&&b&&8*b.length==keySizeInBits){"CBC"==c?h=getRandomBytes(g):(c="ECB",h=new Array),a=formatPlaintext(a),d=keyExpansion(b);for(var i=0;i<a.length/g;i++){if(f=a.slice(i*g,(i+1)*g),"CBC"==c)for(var e=0;g>e;e++)f[e]^=h[i*g+e];h=h.concat(encrypt(f,d))}return h}}function rijndaelDecrypt(a,b,c){var d,g,h,e=blockSizeInBits/8,f=new Array;if(a&&b&&"string"!=typeof a&&8*b.length==keySizeInBits){for(c||(c="ECB"),d=keyExpansion(b),h=a.length/e-1;h>0;h--)if(g=decrypt(a.slice(h*e,(h+1)*e),d),"CBC"==c)for(var i=0;e>i;i++)f[(h-1)*e+i]=g[i]^a[(h-1)*e+i];else f=g.concat(f);return"ECB"==c&&(f=decrypt(a.slice(0,e),d).concat(f)),f}}var keySizeInBits=256,blockSizeInBits=128,roundsArray=[,,,,[,,,,10,,12,,14],,[,,,,12,,12,,14],,[,,,,14,,14,,14]],shiftOffsets=[,,,,[,1,2,3],,[,1,2,3],,[,1,3,4]],Rcon=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],SBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],SBoxInverse=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],Nk=keySizeInBits/32,Nb=blockSizeInBits/32,Nr=roundsArray[Nk][Nb];
function AESprng(a){this.key=new Array,this.key=a,this.itext=hexToByteArray("9F489613248148F9C27945C6AE62EECA3E3367BB14064E4E6DC67A9F28AB3BD1"),this.nbytes=0,this.next=AESprng_next,this.nextbits=AESprng_nextbits,this.nextInt=AESprng_nextInt,this.round=AESprng_round,bsb=blockSizeInBits,blockSizeInBits=256;var b;for(b=0;3>b;b++)this.key=rijndaelEncrypt(this.itext,this.key,"ECB");var d=1+(2&this.key[3])+(1&this.key[9]);for(b=0;d>b;b++)this.key=rijndaelEncrypt(this.itext,this.key,"ECB");blockSizeInBits=bsb}function AESprng_round(){bsb=blockSizeInBits,blockSizeInBits=256,this.key=rijndaelEncrypt(this.itext,this.key,"ECB"),this.nbytes=32,blockSizeInBits=bsb}function AESprng_next(){return this.nbytes<=0&&this.round(),this.key[--this.nbytes]}function AESprng_nextbits(a){var b,c=0,d=Math.floor((a+7)/8);for(b=0;d>b;b++)c=c<<8|this.next();return c&(1<<a)-1}function AESprng_nextInt(a){for(var b=1,c=0;a>=b;)b<<=1,c++;for(b--;;){var d=this.nextbits(c)&b;if(a>=d)return d}}
function array(a){for(i=0;a>i;i++)this[i]=0;this.length=a}function integer(a){return a%4294967296}function shr(a,b){return a=integer(a),b=integer(b),a-2147483648>=0?(a%=2147483648,a>>=b,a+=1073741824>>b-1):a>>=b,a}function shl1(a){return a%=2147483648,a&!0?(a-=1073741824,a*=2,a+=2147483648):a*=2,a}function shl(a,b){a=integer(a),b=integer(b);for(var c=0;b>c;c++)a=shl1(a);return a}function and(a,b){a=integer(a),b=integer(b);var c=a-2147483648,d=b-2147483648;return c>=0?d>=0?(c&d)+2147483648:c&b:d>=0?a&d:a&b}function or(a,b){a=integer(a),b=integer(b);var c=a-2147483648,d=b-2147483648;return c>=0?d>=0?(c|d)+2147483648:(c|b)+2147483648:d>=0?(a|d)+2147483648:a|b}function xor(a,b){a=integer(a),b=integer(b);var c=a-2147483648,d=b-2147483648;return c>=0?d>=0?c^d:(c^b)+2147483648:d>=0?(a^d)+2147483648:a^b}function not(a){return a=integer(a),4294967295-a}function F(a,b,c){return or(and(a,b),and(not(a),c))}function G(a,b,c){return or(and(a,c),and(b,not(c)))}function H(a,b,c){return xor(xor(a,b),c)}function I(a,b,c){return xor(b,or(a,not(c)))}function rotateLeft(a,b){return or(shl(a,b),shr(a,32-b))}function FF(a,b,c,d,e,f,g){return a=a+F(b,c,d)+e+g,a=rotateLeft(a,f),a+=b}function GG(a,b,c,d,e,f,g){return a=a+G(b,c,d)+e+g,a=rotateLeft(a,f),a+=b}function HH(a,b,c,d,e,f,g){return a=a+H(b,c,d)+e+g,a=rotateLeft(a,f),a+=b}function II(a,b,c,d,e,f,g){return a=a+I(b,c,d)+e+g,a=rotateLeft(a,f),a+=b}function transform(a,b){var c=0,d=0,e=0,f=0,g=transformBuffer;for(c=state[0],d=state[1],e=state[2],f=state[3],i=0;16>i;i++)for(g[i]=and(a[4*i+b],255),j=1;4>j;j++)g[i]+=shl(and(a[4*i+j+b],255),8*j);c=FF(c,d,e,f,g[0],S11,3614090360),f=FF(f,c,d,e,g[1],S12,3905402710),e=FF(e,f,c,d,g[2],S13,606105819),d=FF(d,e,f,c,g[3],S14,3250441966),c=FF(c,d,e,f,g[4],S11,4118548399),f=FF(f,c,d,e,g[5],S12,1200080426),e=FF(e,f,c,d,g[6],S13,2821735955),d=FF(d,e,f,c,g[7],S14,4249261313),c=FF(c,d,e,f,g[8],S11,1770035416),f=FF(f,c,d,e,g[9],S12,2336552879),e=FF(e,f,c,d,g[10],S13,4294925233),d=FF(d,e,f,c,g[11],S14,2304563134),c=FF(c,d,e,f,g[12],S11,1804603682),f=FF(f,c,d,e,g[13],S12,4254626195),e=FF(e,f,c,d,g[14],S13,2792965006),d=FF(d,e,f,c,g[15],S14,1236535329),c=GG(c,d,e,f,g[1],S21,4129170786),f=GG(f,c,d,e,g[6],S22,3225465664),e=GG(e,f,c,d,g[11],S23,643717713),d=GG(d,e,f,c,g[0],S24,3921069994),c=GG(c,d,e,f,g[5],S21,3593408605),f=GG(f,c,d,e,g[10],S22,38016083),e=GG(e,f,c,d,g[15],S23,3634488961),d=GG(d,e,f,c,g[4],S24,3889429448),c=GG(c,d,e,f,g[9],S21,568446438),f=GG(f,c,d,e,g[14],S22,3275163606),e=GG(e,f,c,d,g[3],S23,4107603335),d=GG(d,e,f,c,g[8],S24,1163531501),c=GG(c,d,e,f,g[13],S21,2850285829),f=GG(f,c,d,e,g[2],S22,4243563512),e=GG(e,f,c,d,g[7],S23,1735328473),d=GG(d,e,f,c,g[12],S24,2368359562),c=HH(c,d,e,f,g[5],S31,4294588738),f=HH(f,c,d,e,g[8],S32,2272392833),e=HH(e,f,c,d,g[11],S33,1839030562),d=HH(d,e,f,c,g[14],S34,4259657740),c=HH(c,d,e,f,g[1],S31,2763975236),f=HH(f,c,d,e,g[4],S32,1272893353),e=HH(e,f,c,d,g[7],S33,4139469664),d=HH(d,e,f,c,g[10],S34,3200236656),c=HH(c,d,e,f,g[13],S31,681279174),f=HH(f,c,d,e,g[0],S32,3936430074),e=HH(e,f,c,d,g[3],S33,3572445317),d=HH(d,e,f,c,g[6],S34,76029189),c=HH(c,d,e,f,g[9],S31,3654602809),f=HH(f,c,d,e,g[12],S32,3873151461),e=HH(e,f,c,d,g[15],S33,530742520),d=HH(d,e,f,c,g[2],S34,3299628645),c=II(c,d,e,f,g[0],S41,4096336452),f=II(f,c,d,e,g[7],S42,1126891415),e=II(e,f,c,d,g[14],S43,2878612391),d=II(d,e,f,c,g[5],S44,4237533241),c=II(c,d,e,f,g[12],S41,1700485571),f=II(f,c,d,e,g[3],S42,2399980690),e=II(e,f,c,d,g[10],S43,4293915773),d=II(d,e,f,c,g[1],S44,2240044497),c=II(c,d,e,f,g[8],S41,1873313359),f=II(f,c,d,e,g[15],S42,4264355552),e=II(e,f,c,d,g[6],S43,2734768916),d=II(d,e,f,c,g[13],S44,1309151649),c=II(c,d,e,f,g[4],S41,4149444226),f=II(f,c,d,e,g[11],S42,3174756917),e=II(e,f,c,d,g[2],S43,718787259),d=II(d,e,f,c,g[9],S44,3951481745),state[0]+=c,state[1]+=d,state[2]+=e,state[3]+=f}function md5_init(){for(count[0]=count[1]=0,state[0]=1732584193,state[1]=4023233417,state[2]=2562383102,state[3]=271733878,i=0;i<digestBits.length;i++)digestBits[i]=0}function md5_update(a){var b;b=and(shr(count[0],3),63),count[0]<4294967288?count[0]+=8:(count[1]++,count[0]-=4294967296,count[0]+=8),buffer[b]=and(a,255),b>=63&&transform(buffer,0)}function md5_finish(){var b,a=new array(8),c=0,d=0,e=0;for(c=0;4>c;c++)a[c]=and(shr(count[0],8*c),255);for(c=0;4>c;c++)a[c+4]=and(shr(count[1],8*c),255);for(d=and(shr(count[0],3),63),e=56>d?56-d:120-d,b=new array(64),b[0]=128,c=0;e>c;c++)md5_update(b[c]);for(c=0;8>c;c++)md5_update(a[c]);for(c=0;4>c;c++)for(j=0;4>j;j++)digestBits[4*c+j]=and(shr(state[c],8*j),255)}var state=new array(4),count=new array(2);count[0]=0,count[1]=0;var buffer=new array(64),transformBuffer=new array(16),digestBits=new array(16),S11=7,S12=12,S13=17,S14=22,S21=5,S22=9,S23=14,S24=20,S31=4,S32=11,S33=16,S34=23,S41=6,S42=10,S43=15,S44=21;
